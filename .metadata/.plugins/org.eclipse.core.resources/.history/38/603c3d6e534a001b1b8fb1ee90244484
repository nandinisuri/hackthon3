package com.qa.testcases;

import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.IOException;

import org.apache.poi.xssf.usermodel.XSSFRow;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;
import org.openqa.selenium.By;
import org.openqa.selenium.support.ui.Select;
import org.testng.annotations.BeforeMethod;
import org.testng.annotations.Parameters;
import org.testng.annotations.Test;

import com.qaTestBase.TestBASE;

public class feronadmin1_excel extends TestBASE{

		public feronadmin1_excel() throws IOException {
		super();
		// TODO Auto-generated constructor stub
	}

		public void feronadmin_excel() throws IOException {
			
			
		}
		
		@BeforeMethod
		@Parameters("browser")

		public void Start_initialization(String browser) throws IOException {
			
			//
			OpenBrowser(browser);
			//
			GetURL(config.getProperty("AdminURL"));
			
			
			}
		
		@Test
		public void feron_excel() throws IOException, InterruptedException {

			Sendkeys(driver, org.getProperty("admin_un"), config.getProperty("Admin_un"));
			Sendkeys(driver, org.getProperty("admin_pw"), config.getProperty("Admin_pw"));
			Click(driver, org.getProperty("admin_btn"));
			
			Click(driver, org.getProperty("product_list"));
			Click(driver, org.getProperty("Addproduct"));
			
			Click(driver, org.getProperty("purchase"));
			
			// Open the Excel file

			FileInputStream f= new FileInputStream("C:\\Users\\dell\\Desktop\\excel.xlsx");
			XSSFWorkbook wb =new XSSFWorkbook(f);
			XSSFSheet sh=wb.getSheet("Sheet1");
			int rowCount = sh.getLastRowNum();
	        System.out.println(rowCount);
	        int colCount = sh.getRow(0).getLastCellNum();
	        System.out.println(colCount);
			
	        //for (int i = 1; i < rowCount; i++) {

				//XSSFRow row = sh.getRow(i);

				String row1=sh.getRow(0).getCell(0).getStringCellValue();
				System.out.println(rowCount+"   "+row1+"  " );

					//Print Excel data in console

					Sendkeys(driver, org.getProperty("productname"),getRow(1).getCell(0).getStringCellValue());
					Sendkeys(driver, org.getProperty("producttype"),getRow(1).getCell(1).getStringCellValue());
					
				}

	
				
	        }
		
		
		
